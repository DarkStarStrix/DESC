
 ____  ____  _____   ___ 
|  _ \| ___|/  ___|/ ___|
| | \ | |_  | (__ | |
| | | |  _| \___ \| |
| |_/ | |__  ___) | |___ 
|____/|____||____/ \____|
                         

DESC version 0.5.1+112.g61461c5.dirty, using JAX backend, jax version=0.2.25, jaxlib version=0.1.76, dtype=float64
Using device: CPU, with 13.48 GB available memory
Reading input from /home/kaya/Documents/edu/pton/plasma/DESC/examples/DESC/current/HELIOTRON
Outputs will be written to /home/kaya/Documents/edu/pton/plasma/DESC/examples/DESC/current/HELIOTRON_output.h5
================
Step 1/3
================
Spectral indexing: fringe
Spectral resolution (L,M,N)=(12,6,0)
Node pattern: jacobi
Node resolution (L,M,N)=(24,12,0)
Boundary ratio = 0.0
Pressure ratio = 0.0
Perturbation Order = 2
Objective: force
Optimizer: lsq-exact
Function tolerance = 0.01
Gradient tolerance = 1e-06
State vector tolerance = 1e-06
Max function evaluations = 200
================
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 388 ms
Timer: Objective build = 390 ms
Compiling objective function and derivatives
Timer: Objective compilation time = 4.32 sec
Timer: Jacobian compilation time = 7.77 sec
Timer: Total compilation time = 12.0 sec
Factorizing linear constraints
Timer: linear constraint factorize = 256 ms
Number of parameters: 108
Number of objectives: 338
Starting optimization
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         9.3437e+10                                    1.98e+13    
       1              2         4.6468e+10      4.70e+10       3.79e-01       2.99e+13    
       2              4         8.5968e+08      4.56e+10       1.51e-01       3.52e+12    
       3              5         6.8429e+07      7.91e+08       6.76e-02       6.09e+11    
       4              6         5.6977e+06      6.27e+07       2.69e-02       9.94e+10    
       5              8         3.6106e+05      5.34e+06       1.28e-02       1.78e+10    
       6             10         6.5198e+04      2.96e+05       5.20e-03       1.40e+10    
       7             12         1.0040e+04      5.52e+04       1.95e-03       9.60e+08    
       8             14         8.7734e+03      1.27e+03       1.25e-03       1.56e+08    
       9             16         8.6901e+03      8.34e+01       6.09e-04       4.82e+07    
Optimization terminated successfully.
`ftol` condition satisfied.
         Current function value: 8.690e+03
         Iterations: 9
         Function evaluations: 16
         Jacobian evaluations: 10
Timer: Solution time = 1.44 sec
Timer: Avg time per step = 160 ms
Start of solver
Total (sum of squares):  9.344e+10, 
Total force:  4.323e+05 (N)
End of solver
Total (sum of squares):  8.690e+03, 
Total force:  1.318e+02 (N)
Saving latest iteration
Timer: Iteration 1 total = 22.9 sec
================
Step 2/3
================
Spectral indexing: fringe
Spectral resolution (L,M,N)=(18,9,0)
Node pattern: jacobi
Node resolution (L,M,N)=(36,18,0)
Boundary ratio = 0.0
Pressure ratio = 1.0
Perturbation Order = 2
Objective: force
Optimizer: lsq-exact
Function tolerance = 0.01
Gradient tolerance = 1e-06
State vector tolerance = 1e-06
Max function evaluations = 200
================
Perturbing equilibrium
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 510 ms
Timer: Objective build = 513 ms
Perturbing p_l
Factorizing linear constraints
Timer: linear constraint factorize = 248 ms
Computing df
Timer: df computation = 16.5 sec
Factoring df
Timer: df/dx factorization = 24.8 ms
Computing d^2f
Timer: d^2f computation = 24.8 sec
||dx||/||x|| =  1.494e-02
Timer: Total perturbation = 46.3 sec
Compiling objective function and derivatives
Timer: Objective compilation time = 236 us
Timer: Jacobian compilation time = 50.7 ms
Timer: Total compilation time = 51.2 ms
Factorizing linear constraints
Timer: linear constraint factorize = 18.0 ms
Number of parameters: 243
Number of objectives: 722
Starting optimization
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         5.3041e+07                                    2.70e+11    
       1              2         3.1506e+07      2.15e+07       4.21e-02       4.79e+11    
       2              3         3.7459e+05      3.11e+07       1.12e-02       1.16e+11    
       3              5         5.0345e+04      3.24e+05       4.23e-03       4.30e+10    
       4              7         4.3159e+03      4.60e+04       2.59e-03       1.80e+10    
       5              9         1.5623e+03      2.75e+03       1.17e-03       1.14e+10    
       6             10         1.6263e+02      1.40e+03       1.45e-03       2.19e+09    
       7             12         5.5188e+00      1.57e+02       7.13e-04       3.38e+08    
       8             14         1.1455e+00      4.37e+00       2.93e-04       1.33e+08    
       9             16         6.0446e-01      5.41e-01       1.47e-04       6.10e+07    
      10             18         5.4352e-01      6.09e-02       7.19e-05       1.40e+07    
      11             20         5.4004e-01      3.48e-03       3.57e-05       3.42e+06    
Optimization terminated successfully.
`ftol` condition satisfied.
         Current function value: 5.400e-01
         Iterations: 11
         Function evaluations: 20
         Jacobian evaluations: 12
Timer: Solution time = 2.79 sec
Timer: Avg time per step = 254 ms
Start of solver
Total (sum of squares):  5.304e+07, 
Total force:  1.030e+04 (N)
End of solver
Total (sum of squares):  5.400e-01, 
Total force:  1.039e+00 (N)
Saving latest iteration
Timer: Iteration 2 total = 1.02 min
================
Step 3/3
================
Spectral indexing: fringe
Spectral resolution (L,M,N)=(24,12,3)
Node pattern: jacobi
Node resolution (L,M,N)=(36,18,6)
Boundary ratio = 1.0
Pressure ratio = 1.0
Perturbation Order = 2
Objective: force
Optimizer: lsq-exact
Function tolerance = 0.01
Gradient tolerance = 1e-06
State vector tolerance = 1e-06
Max function evaluations = 200
================
Perturbing equilibrium
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 588 ms
Timer: Objective build = 596 ms
Perturbing Rb_lmn, Zb_lmn
Factorizing linear constraints
Timer: linear constraint factorize = 3.71 sec
Computing df
Timer: df computation = 1.14 min
Factoring df
Timer: df/dx factorization = 33.8 sec
Computing d^2f
Timer: d^2f computation = 52.0 sec
||dx||/||x|| =  5.852e-02
Timer: Total perturbation = 2.97 min
Compiling objective function and derivatives
Timer: Objective compilation time = 3.62 ms
Timer: Jacobian compilation time = 8.02 sec
Timer: Total compilation time = 8.02 sec
Factorizing linear constraints
Timer: linear constraint factorize = 3.36 sec
Number of parameters: 3168
Number of objectives: 9386
Starting optimization
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         1.4016e+23                                    1.51e+28    
       1              2         4.9004e+22      9.12e+22       2.05e+00       8.69e+26    
       2              4         2.5881e+22      2.31e+22       1.21e+00       1.18e+27    
       3              5         2.3719e+22      2.16e+21       1.22e+00       2.74e+27    
       4              6         9.8962e+19      2.36e+22       4.11e-01       5.89e+24    
       5              8         2.0104e+19      7.89e+19       2.66e-01       8.69e+23    
       6              9         2.6664e+18      1.74e+19       2.79e-01       7.84e+22    
       7             15         5.1941e+17      2.15e+18       7.53e-01       1.16e+22    
       8             16         8.1647e+16      4.38e+17       8.53e-01       1.00e+21    
       9             17         1.3132e+16      6.85e+16       5.83e-01       8.77e+19    
      10             20         1.2455e+16      6.77e+14       2.62e-01       1.33e+20    
      11             21         2.3966e+15      1.01e+16       1.14e-01       2.54e+19    
      12             23         1.5844e+15      8.12e+14       3.92e-02       2.56e+19    
      13             24         1.3587e+15      2.26e+14       4.10e-02       6.97e+19    
      14             25         1.0370e+15      3.22e+14       6.14e-02       5.00e+19    
      15             27         8.9615e+14      1.41e+14       1.24e-02       4.02e+18    
      16             28         8.3742e+14      5.87e+13       1.91e-02       4.03e+18    
      17             29         7.6089e+14      7.65e+13       4.66e-02       7.53e+18    
      18             30         7.3661e+14      2.43e+13       8.82e-02       5.56e+18    
      19             31         6.5780e+14      7.88e+13       1.06e-02       1.89e+18    
      20             32         6.3730e+14      2.05e+13       1.81e-02       1.78e+18    
      21             33         6.1884e+14      1.85e+13       2.01e-02       1.67e+18    
      22             34         6.0131e+14      1.75e+13       2.01e-02       1.63e+18    
      23             35         5.8402e+14      1.73e+13       1.94e-02       1.53e+18    
      24             36         5.6763e+14      1.64e+13       1.98e-02       1.50e+18    
      25             37         5.5148e+14      1.62e+13       1.92e-02       1.41e+18    
      26             38         5.3624e+14      1.52e+13       1.93e-02       1.39e+18    
      27             39         5.2123e+14      1.50e+13       1.88e-02       1.31e+18    
      28             40         5.0711e+14      1.41e+13       1.87e-02       1.30e+18    
      29             41         4.9318e+14      1.39e+13       1.84e-02       1.22e+18    
      30             42         4.8007e+14      1.31e+13       1.81e-02       1.21e+18    
      31             43         4.6709e+14      1.30e+13       1.79e-02       1.14e+18    
      32             44         4.5488e+14      1.22e+13       1.76e-02       1.14e+18    
      33             45         4.4274e+14      1.21e+13       1.76e-02       1.07e+18    
      34             46         4.3130e+14      1.14e+13       1.72e-02       1.07e+18    
      35             47         4.1991e+14      1.14e+13       1.74e-02       1.01e+18    
      36             48         4.0917e+14      1.07e+13       1.69e-02       1.01e+18    
      37             49         3.9844e+14      1.07e+13       1.72e-02       9.47e+17    
      38             50         3.8833e+14      1.01e+13       1.67e-02       9.46e+17    
      39             51         3.7821e+14      1.01e+13       1.71e-02       8.89e+17    
      40             52         3.6866e+14      9.55e+12       1.65e-02       8.88e+17    
      41             53         3.5911e+14      9.56e+12       1.70e-02       8.35e+17    
      42             54         3.5007e+14      9.03e+12       1.64e-02       8.33e+17    
      43             55         3.4103e+14      9.04e+12       1.69e-02       7.82e+17    
      44             56         3.3246e+14      8.57e+12       1.63e-02       7.80e+17    
      45             57         3.2390e+14      8.56e+12       1.68e-02       7.32e+17    
      46             58         3.1575e+14      8.15e+12       1.63e-02       7.28e+17    
      47             59         3.0763e+14      8.12e+12       1.68e-02       6.84e+17    
      48             60         2.9986e+14      7.77e+12       1.63e-02       6.78e+17    
      49             61         2.9215e+14      7.71e+12       1.67e-02       6.37e+17    
      50             62         2.8473e+14      7.43e+12       1.63e-02       6.30e+17    
      51             63         2.7740e+14      7.33e+12       1.67e-02       5.92e+17    
      52             64         2.7029e+14      7.11e+12       1.63e-02       5.82e+17    
      53             65         2.6332e+14      6.97e+12       1.67e-02       5.48e+17    
      54             66         2.5650e+14      6.82e+12       1.63e-02       5.36e+17    
      55             67         2.4986e+14      6.64e+12       1.67e-02       5.05e+17    
      56             68         2.4332e+14      6.54e+12       1.63e-02       4.91e+17    
      57             69         2.3700e+14      6.32e+12       1.67e-02       4.63e+17    
      58             70         2.3074e+14      6.26e+12       1.63e-02       4.47e+17    
      59             71         2.2472e+14      6.02e+12       1.66e-02       4.22e+17    
      60             72         2.1874e+14      5.98e+12       1.63e-02       4.04e+17    
      61             73         2.0919e+14      9.55e+12       3.34e-02       4.42e+17    
      62             74         2.0246e+14      6.72e+12       2.71e-02       4.88e+17    
      63             75         1.9750e+14      4.96e+12       2.47e-02       4.97e+17    
      64             76         1.9116e+14      6.35e+12       4.80e-03       3.73e+17    
      65             77         1.8616e+14      5.00e+12       1.30e-02       3.18e+17    
      66             78         1.8154e+14      4.62e+12       1.54e-02       2.88e+17    
      67             79         1.7427e+14      7.27e+12       2.95e-02       2.78e+17    
      68             80         1.7090e+14      3.37e+12       2.32e-02       2.99e+17    
      69             81         1.6618e+14      4.72e+12       4.20e-03       2.39e+17    
      70             82         1.6231e+14      3.87e+12       1.17e-02       2.16e+17    
      71             83         1.5862e+14      3.68e+12       1.34e-02       2.02e+17    
      72             84         1.5503e+14      3.60e+12       1.39e-02       1.88e+17    
      73             85         1.5005e+14      4.98e+12       2.50e-02       1.89e+17    
      74             86         1.4650e+14      3.55e+12       2.37e-02       1.69e+17    
      75             87         1.4271e+14      3.79e+12       1.38e-02       1.69e+17    
      76             88         1.3900e+14      3.71e+12       2.91e-02       1.45e+17    
      77             89         1.3620e+14      2.80e+12       1.70e-02       1.44e+17    
      78             90         1.3282e+14      3.39e+12       8.22e-03       1.35e+17    
      79             91         1.3025e+14      2.57e+12       1.77e-02       1.16e+17    
      80             92         1.2781e+14      2.43e+12       8.20e-03       1.24e+17    
      81             93         1.2545e+14      2.36e+12       1.66e-02       1.07e+17    
      82             94         1.2319e+14      2.26e+12       7.86e-03       1.14e+17    
      83             95         1.2098e+14      2.20e+12       1.65e-02       9.68e+16    
      84             96         1.1887e+14      2.11e+12       7.73e-03       1.04e+17    
      85             97         1.1682e+14      2.05e+12       1.66e-02       8.73e+16    
      86             98         1.1485e+14      1.97e+12       7.76e-03       9.57e+16    
      87             99         1.1293e+14      1.91e+12       1.67e-02       8.11e+16    
      88             100        1.1109e+14      1.84e+12       7.96e-03       8.82e+16    
      89             101        1.0931e+14      1.79e+12       1.68e-02       7.63e+16    
      90             102        1.0759e+14      1.72e+12       8.28e-03       8.16e+16    
      91             103        1.0592e+14      1.67e+12       1.70e-02       7.19e+16    
      92             104        1.0431e+14      1.61e+12       8.69e-03       7.58e+16    
      93             105        1.0275e+14      1.56e+12       1.71e-02       6.78e+16    
      94             106        1.0124e+14      1.51e+12       9.14e-03       7.05e+16    
      95             107        9.9769e+13      1.47e+12       1.72e-02       6.41e+16    
      
# I manually stopped here, because not converging.
