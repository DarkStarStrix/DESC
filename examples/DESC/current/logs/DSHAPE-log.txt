
 ____  ____  _____   ___ 
|  _ \| ___|/  ___|/ ___|
| | \ | |_  | (__ | |
| | | |  _| \___ \| |
| |_/ | |__  ___) | |___ 
|____/|____||____/ \____|
                         

DESC version 0.5.1+112.g61461c5.dirty, using JAX backend, jax version=0.2.25, jaxlib version=0.1.76, dtype=float64
Using device: CPU, with 12.86 GB available memory
Reading input from /home/kaya/Documents/edu/pton/plasma/DESC/examples/DESC/current/DSHAPE
Outputs will be written to /home/kaya/Documents/edu/pton/plasma/DESC/examples/DESC/current/DSHAPE_output.h5
================
Step 1/3
================
Spectral indexing: fringe
Spectral resolution (L,M,N)=(12,6,0)
Node pattern: jacobi
Node resolution (L,M,N)=(24,12,0)
Boundary ratio = 1.0
Pressure ratio = 0.0
Perturbation Order = 2
Objective: force
Optimizer: lsq-exact
Function tolerance = 0.01
Gradient tolerance = 1e-06
State vector tolerance = 1e-06
Max function evaluations = 100
================
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 410 ms
Timer: Objective build = 412 ms
Compiling objective function and derivatives
Timer: Objective compilation time = 4.63 sec
Timer: Jacobian compilation time = 9.73 sec
Timer: Total compilation time = 14.3 sec
Factorizing linear constraints
Timer: linear constraint factorize = 254 ms
Number of parameters: 108
Number of objectives: 338
Starting optimization
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         2.2073e+10                                    2.57e+12    
       1              3         2.1609e+09      1.99e+10       5.69e-01       6.15e+11    
       2              4         1.7822e+07      2.14e+09       1.39e-01       1.52e+11    
       3              5         2.6988e+06      1.51e+07       9.04e-02       6.81e+10    
       4              6         9.1591e+05      1.78e+06       4.21e-02       2.12e+10    
       5              7         7.4473e+05      1.71e+05       4.18e-02       1.53e+10    
       6              8         9.0787e+03      7.36e+05       9.16e-03       1.62e+09    
       7              9         7.9379e+03      1.14e+03       1.11e-02       7.57e+08    
       8             10         2.7644e+03      5.17e+03       3.68e-03       1.01e+08    
       9             12         2.7053e+03      5.91e+01       2.39e-03       4.47e+07    
      10             14         2.6980e+03      7.34e+00       1.27e-03       7.32e+06    
Optimization terminated successfully.
`ftol` condition satisfied.
         Current function value: 2.698e+03
         Iterations: 10
         Function evaluations: 14
         Jacobian evaluations: 11
Timer: Solution time = 1.54 sec
Timer: Avg time per step = 154 ms
Start of solver
Total (sum of squares):  2.207e+10, 
Total force:  2.101e+05 (N)
End of solver
Total (sum of squares):  2.698e+03, 
Total force:  7.346e+01 (N)
Saving latest iteration
Timer: Iteration 1 total = 30.7 sec
================
Step 2/3
================
Spectral indexing: fringe
Spectral resolution (L,M,N)=(20,10,0)
Node pattern: jacobi
Node resolution (L,M,N)=(40,20,0)
Boundary ratio = 1.0
Pressure ratio = 0.0
Perturbation Order = 2
Objective: force
Optimizer: lsq-exact
Function tolerance = 0.01
Gradient tolerance = 1e-06
State vector tolerance = 1e-06
Max function evaluations = 100
================
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 619 ms
Timer: Objective build = 623 ms
Compiling objective function and derivatives
Timer: Objective compilation time = 4.81 sec
Timer: Jacobian compilation time = 8.74 sec
Timer: Total compilation time = 13.5 sec
Factorizing linear constraints
Timer: linear constraint factorize = 362 ms
Number of parameters: 300
Number of objectives: 882
Starting optimization
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         1.0055e+03                                    2.38e+08    
       1              5         7.4748e+01      9.31e+02       6.71e-03       3.83e+08    
       2              7         1.9801e+01      5.49e+01       4.11e-03       1.96e+08    
       3              9         8.0432e+00      1.18e+01       1.99e-03       5.10e+07    
       4             10         3.4894e+00      4.55e+00       2.35e-03       6.21e+07    
       5             12         1.7401e+00      1.75e+00       5.43e-04       1.10e+07    
       6             14         1.3769e+00      3.63e-01       2.51e-04       3.15e+06    
       7             15         1.2545e+00      1.22e-01       4.69e-04       1.25e+07    
       8             16         1.1457e+00      1.09e-01       4.56e-04       1.39e+07    
       9             17         1.0242e+00      1.22e-01       4.85e-04       9.89e+06    
      10             18         9.4923e-01      7.50e-02       5.14e-04       8.99e+06    
      11             19         8.9782e-01      5.14e-02       5.25e-04       7.31e+06    
      12             20         8.5716e-01      4.07e-02       4.89e-04       5.21e+06    
      13             21         8.3616e-01      2.10e-02       4.49e-04       5.93e+06    
      14             22         8.2267e-01      1.35e-02       4.32e-04       6.50e+06    
      15             23         8.1062e-01      1.21e-02       4.27e-04       6.61e+06    
      16             24         7.9921e-01      1.14e-02       4.26e-04       6.36e+06    
      17             25         7.8888e-01      1.03e-02       4.25e-04       5.96e+06    
      18             26         7.8007e-01      8.80e-03       4.22e-04       5.64e+06    
      19             27         7.7281e-01      7.26e-03       4.18e-04       5.47e+06    
Optimization terminated successfully.
`ftol` condition satisfied.
         Current function value: 7.728e-01
         Iterations: 19
         Function evaluations: 27
         Jacobian evaluations: 20
Timer: Solution time = 5.41 sec
Timer: Avg time per step = 284 ms
Start of solver
Total (sum of squares):  1.006e+03, 
Total force:  4.484e+01 (N)
End of solver
Total (sum of squares):  7.728e-01, 
Total force:  1.243e+00 (N)
Saving latest iteration
Timer: Iteration 2 total = 32.1 sec
================
Step 3/3
================
Spectral indexing: fringe
Spectral resolution (L,M,N)=(26,13,0)
Node pattern: jacobi
Node resolution (L,M,N)=(52,26,0)
Boundary ratio = 1.0
Pressure ratio = 1.0
Perturbation Order = 2
Objective: force
Optimizer: lsq-exact
Function tolerance = 0.01
Gradient tolerance = 1e-06
State vector tolerance = 1e-06
Max function evaluations = 100
================
Perturbing equilibrium
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 1.61 sec
Timer: Objective build = 1.62 sec
Perturbing p_l
Factorizing linear constraints
Timer: linear constraint factorize = 357 ms
Computing df
Timer: df computation = 24.2 sec
Factoring df
Timer: df/dx factorization = 166 ms
Computing d^2f
Timer: d^2f computation = 48.0 sec
||dx||/||x|| =  4.606e-02
Timer: Total perturbation = 1.35 min
Compiling objective function and derivatives
Timer: Objective compilation time = 1.01 ms
Timer: Jacobian compilation time = 225 ms
Timer: Total compilation time = 227 ms
Factorizing linear constraints
Timer: linear constraint factorize = 66.0 ms
Number of parameters: 507
Number of objectives: 1458
Starting optimization
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         5.0568e+05                                    2.23e+10    
       1              2         1.1704e+04      4.94e+05       1.23e-02       6.89e+09    
       2              4         2.7838e+03      8.92e+03       6.27e-03       4.93e+09    
       3              6         6.0397e+02      2.18e+03       3.16e-03       2.27e+09    
       4              8         4.3958e+01      5.60e+02       1.66e-03       6.00e+08    
       5             10         1.1750e+01      3.22e+01       8.48e-04       3.46e+08    
       6             11         1.5083e+00      1.02e+01       8.90e-04       1.31e+08    
       7             13         3.7800e-01      1.13e+00       4.15e-04       7.08e+07    
       8             15         2.1458e-02      3.57e-01       2.30e-04       1.34e+07    
       9             17         1.1758e-02      9.70e-03       1.18e-04       3.81e+06    
      10             19         1.0848e-02      9.09e-04       5.96e-05       1.32e+06    
      11             21         1.0672e-02      1.76e-04       3.00e-05       4.13e+05    
      12             23         1.0638e-02      3.44e-05       1.51e-05       1.15e+05    
Optimization terminated successfully.
`ftol` condition satisfied.
         Current function value: 1.064e-02
         Iterations: 12
         Function evaluations: 23
         Jacobian evaluations: 13
Timer: Solution time = 7.34 sec
Timer: Avg time per step = 611 ms
Start of solver
Total (sum of squares):  5.057e+05, 
Total force:  1.006e+03 (N)
End of solver
Total (sum of squares):  1.064e-02, 
Total force:  1.459e-01 (N)
Saving latest iteration
Timer: Iteration 3 total = 1.72 min
====================
Done
Timer: Total time = 2.78 min
Output written to /home/kaya/Documents/edu/pton/plasma/DESC/examples/DESC/current/DSHAPE_output.h5
====================
