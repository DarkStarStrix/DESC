
 ____  ____  _____   ___ 
|  _ \| ___|/  ___|/ ___|
| | \ | |_  | (__ | |
| | | |  _| \___ \| |
| |_/ | |__  ___) | |___ 
|____/|____||____/ \____|
                         

DESC version 0.5.1+118.g71ace73.dirty, using JAX backend, jax version=0.2.25, jaxlib version=0.1.76, dtype=float64
Using device: CPU, with 7.99 GB available memory
Reading input from /home/kaya/Documents/edu/pton/plasma/DESC/examples/DESC/current/HELIOTRON
Outputs will be written to /home/kaya/Documents/edu/pton/plasma/DESC/examples/DESC/current/HELIOTRON_output.h5
================
Step 1/3
================
Spectral indexing: fringe
Spectral resolution (L,M,N)=(12,6,0)
Node pattern: quad
Node resolution (L,M,N)=(24,12,0)
Boundary ratio = 0.0
Pressure ratio = 0.0
Perturbation Order = 2
Objective: force
Optimizer: lsq-exact
Function tolerance = 0.01
Gradient tolerance = 1e-06
State vector tolerance = 1e-06
Max function evaluations = 75
================
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 578 ms
Timer: Objective build = 639 ms
Compiling objective function and derivatives
Timer: Objective compilation time = 5.12 sec
Timer: Jacobian compilation time = 9.69 sec
Timer: Total compilation time = 14.8 sec
Factorizing linear constraints
Timer: linear constraint factorize = 238 ms
Number of parameters: 57
Number of objectives: 182
Starting optimization
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         4.2177e+11                                    6.84e+13    
       1              5         3.9617e+10      3.82e+11       2.08e-01       1.92e+13    
       2              6         1.0457e+09      3.86e+10       1.02e-01       4.40e+12    
       3              7         5.4014e+07      9.92e+08       6.35e-02       1.40e+11    
       4              8         1.8442e+07      3.56e+07       5.14e-02       1.85e+11    
       5              9         1.0621e+07      7.82e+06       2.44e-02       1.44e+11    
       6             10         6.1760e+06      4.45e+06       2.72e-02       1.13e+11    
       7             12         4.7278e+06      1.45e+06       1.05e-02       1.04e+11    
       8             14         3.9476e+06      7.80e+05       5.45e-03       4.22e+10    
       9             15         3.5385e+06      4.09e+05       1.23e-02       1.04e+11    
      10             16         3.0039e+06      5.35e+05       1.30e-02       5.61e+10    
      11             18         2.7678e+06      2.36e+05       6.23e-03       8.24e+09    
      12             19         2.6837e+06      8.41e+04       1.15e-02       1.67e+10    
      13             20         2.6185e+06      6.51e+04       1.04e-02       1.69e+10    
      14             21         2.5377e+06      8.08e+04       5.41e-03       5.37e+09    
      15             22         2.5288e+06      8.90e+03       1.30e-03       1.17e+08    
Optimization terminated successfully.
`ftol` condition satisfied.
         Current function value: 2.529e+06
         Iterations: 15
         Function evaluations: 22
         Jacobian evaluations: 16
Timer: Solution time = 1.36 sec
Timer: Avg time per step = 91.1 ms
Start of solver
Total (sum of squares):  4.218e+11, 
Total force:  9.184e+05 (N)
End of solver
Total (sum of squares):  2.529e+06, 
Total force:  2.249e+03 (N)
Saving latest iteration
Timer: Iteration 1 total = 28.4 sec
================
Step 2/3
================
Spectral indexing: fringe
Spectral resolution (L,M,N)=(18,9,0)
Node pattern: quad
Node resolution (L,M,N)=(36,18,0)
Boundary ratio = 0.0
Pressure ratio = 1.0
Perturbation Order = 2
Objective: force
Optimizer: lsq-exact
Function tolerance = 0.01
Gradient tolerance = 1e-06
State vector tolerance = 1e-06
Max function evaluations = 75
================
Perturbing equilibrium
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 811 ms
Timer: Objective build = 815 ms
Perturbing p_l
Factorizing linear constraints
Timer: linear constraint factorize = 192 ms
Computing df
Timer: df computation = 27.2 sec
Factoring df
Timer: df/dx factorization = 62.1 ms
Computing d^2f
Timer: d^2f computation = 47.8 sec
||dx||/||x|| =  1.108e-02
Timer: Total perturbation = 1.37 min
Compiling objective function and derivatives
Timer: Objective compilation time = 497 us
Timer: Jacobian compilation time = 24.5 ms
Timer: Total compilation time = 25.5 ms
Factorizing linear constraints
Timer: linear constraint factorize = 9.28 ms
Number of parameters: 126
Number of objectives: 380
Starting optimization
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         9.9443e+07                                    1.08e+12    
       1              3         5.1929e+06      9.42e+07       3.00e-02       6.98e+11    
       2              5         5.9938e+05      4.59e+06       1.11e-02       1.34e+11    
       3              7         6.9663e+04      5.30e+05       4.82e-03       3.82e+10    
       4              9         1.5198e+04      5.45e+04       2.55e-03       1.88e+10    
       5             11         7.5337e+03      7.66e+03       1.36e-03       3.82e+09    
       6             13         7.2652e+03      2.69e+02       7.64e-04       5.56e+08    
       7             15         7.2392e+03      2.60e+01       3.85e-04       1.20e+08    
Optimization terminated successfully.
`ftol` condition satisfied.
         Current function value: 7.239e+03
         Iterations: 7
         Function evaluations: 15
         Jacobian evaluations: 8
Timer: Solution time = 2.34 sec
Timer: Avg time per step = 334 ms
Start of solver
Total (sum of squares):  9.944e+07, 
Total force:  1.410e+04 (N)
End of solver
Total (sum of squares):  7.239e+03, 
Total force:  1.203e+02 (N)
Saving latest iteration
Timer: Iteration 2 total = 1.71 min
================
Step 3/3
================
Spectral indexing: fringe
Spectral resolution (L,M,N)=(24,12,3)
Node pattern: quad
Node resolution (L,M,N)=(36,18,6)
Boundary ratio = 1.0
Pressure ratio = 1.0
Perturbation Order = 2
Objective: force
Optimizer: lsq-exact
Function tolerance = 0.01
Gradient tolerance = 1e-06
State vector tolerance = 1e-06
Max function evaluations = 75
================
Perturbing equilibrium
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 872 ms
Timer: Objective build = 880 ms
Perturbing Rb_lmn, Zb_lmn
Factorizing linear constraints
Timer: linear constraint factorize = 2.50 sec
Computing df
Timer: df computation = 1.19 min
Factoring df
Timer: df/dx factorization = 7.47 sec
Computing d^2f
Timer: d^2f computation = 1.46 min
||dx||/||x|| =  5.767e-02
Timer: Total perturbation = 3.28 min
Compiling objective function and derivatives
Timer: Objective compilation time = 3.65 ms
Timer: Jacobian compilation time = 3.02 sec
Timer: Total compilation time = 3.02 sec
Factorizing linear constraints
Timer: linear constraint factorize = 696 ms
Number of parameters: 1590
Number of objectives: 4940
Starting optimization
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         6.6251e+18                                    9.17e+22    
       1              6         2.9535e+17      6.33e+18       1.01e+00       2.62e+21    
       2              7         6.7146e+16      2.28e+17       6.97e-01       7.32e+20    
       3              8         1.1978e+16      5.52e+16       7.24e-01       1.21e+20    
       4              9         1.1464e+15      1.08e+16       6.09e-01       1.08e+19    
       5             12         2.6485e+14      8.82e+14       4.26e-01       2.74e+18    
       6             13         1.1967e+14      1.45e+14       4.33e-01       8.06e+17    
       7             16         7.7920e+12      1.12e+14       1.20e-01       4.52e+17    
       8             21         4.8530e+12      2.94e+12       4.42e-02       3.41e+17    
       9             22         1.9340e+12      2.92e+12       2.79e-02       5.62e+17    
      10             23         1.4154e+12      5.19e+11       3.71e-02       1.11e+18    
      11             24         4.4356e+11      9.72e+11       2.66e-02       3.98e+17    
      12             25         1.8203e+11      2.62e+11       2.10e-02       4.87e+17    
      13             27         1.3985e+11      4.22e+10       9.73e-03       1.08e+17    
      14             28         1.2033e+11      1.95e+10       1.05e-02       8.34e+16    
      15             30         1.0156e+11      1.88e+10       4.89e-03       5.40e+14    
      16             31         9.5604e+10      5.96e+09       2.65e-03       4.33e+15    
      17             33         9.3230e+10      2.37e+09       1.36e-03       1.32e+15    
      18             34         8.8807e+10      4.42e+09       1.96e-03       9.95e+15    
      19             36         8.7084e+10      1.72e+09       1.05e-03       2.45e+15    
      20             37         8.3706e+10      3.38e+09       1.62e-03       1.63e+16    
      21             38         8.0962e+10      2.74e+09       2.68e-03       1.05e+17    
      22             39         7.7374e+10      3.59e+09       2.87e-03       1.52e+17    
      23             40         7.5599e+10      1.78e+09       3.33e-03       1.71e+17    
      24             41         7.0343e+10      5.26e+09       1.16e-03       4.06e+15    
      25             42         6.8940e+10      1.40e+09       1.46e-03       5.69e+16    
      26             44         6.7848e+10      1.09e+09       7.50e-04       1.41e+16    
      27             45         6.6747e+10      1.10e+09       1.47e-03       7.11e+16    
      28             46         6.5341e+10      1.41e+09       1.39e-03       7.54e+16    
      29             48         6.4259e+10      1.08e+09       8.70e-04       1.80e+16    
      30             49         6.3424e+10      8.35e+08       1.41e-03       8.55e+16    
      31             50         6.2201e+10      1.22e+09       1.55e-03       8.67e+16    
      32             51         6.1047e+10      1.15e+09       1.51e-03       8.99e+16    
      33             52         6.0030e+10      1.02e+09       1.78e-03       9.02e+16    
      34             53         5.8955e+10      1.07e+09       1.84e-03       8.67e+16    
      35             54         5.8375e+10      5.80e+08       2.23e-03       8.34e+16    
Optimization terminated successfully.
`ftol` condition satisfied.
         Current function value: 5.838e+10
         Iterations: 35
         Function evaluations: 54
         Jacobian evaluations: 36
Timer: Solution time = 9.71 min
Timer: Avg time per step = 16.6 sec
Start of solver
Total (sum of squares):  6.625e+18, 
Total force:  3.640e+09 (N)
End of solver
Total (sum of squares):  5.838e+10, 
Total force:  3.417e+05 (N)
Saving latest iteration
Timer: Iteration 3 total = 14.4 min
====================
Done
Timer: Total time = 16.6 min
Output written to /home/kaya/Documents/edu/pton/plasma/DESC/examples/DESC/current/HELIOTRON_output.h5
====================
