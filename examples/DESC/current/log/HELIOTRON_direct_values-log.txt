
 ____  ____  _____   ___ 
|  _ \| ___|/  ___|/ ___|
| | \ | |_  | (__ | |
| | | |  _| \___ \| |
| |_/ | |__  ___) | |___ 
|____/|____||____/ \____|
                         

DESC version 0.5.1+132.g5c24a9f.dirty, using JAX backend, jax version=0.2.25, jaxlib version=0.1.76, dtype=float64
Using device: CPU, with 13.40 GB available memory
Reading input from /home/kaya/Documents/edu/pton/plasma/DESC/current/examples/DESC/current/HELIOTRON_direct_values
Outputs will be written to /home/kaya/Documents/edu/pton/plasma/DESC/current/examples/DESC/current/HELIOTRON_direct_values_output.h5
================
Step 1/3
================
Spectral indexing: fringe
Spectral resolution (L,M,N)=(24,12,3)
Node pattern: quad
Node resolution (L,M,N)=(36,18,6)
Boundary ratio = 0.0
Pressure ratio = 0.0
Perturbation Order = 2
Objective: force
Optimizer: lsq-exact
Function tolerance = 0.01
Gradient tolerance = 1e-06
State vector tolerance = 1e-06
Max function evaluations = 150
================
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 888 ms
Timer: Objective build = 965 ms
Compiling objective function and derivatives
Timer: Objective compilation time = 9.72 sec
Timer: Jacobian compilation time = 33.3 sec
Timer: Total compilation time = 43.0 sec
Factorizing linear constraints
Timer: linear constraint factorize = 845 ms
Number of parameters: 1590
Number of objectives: 35594
Starting optimization
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         1.3903e+09                                    6.16e+11    
       1              6         4.1835e+07      1.35e+09       1.51e-01       1.43e+11    
       2              7         2.0199e+05      4.16e+07       5.02e-02       1.11e+10    
       3              8         5.1353e+03      1.97e+05       1.46e-02       4.69e+08    
       4              9         3.0605e+02      4.83e+03       6.60e-03       1.05e+08    
       5             10         1.5835e+01      2.90e+02       2.97e-03       4.38e+07    
       6             11         2.6134e+00      1.32e+01       1.62e-03       8.81e+07    
       7             13         1.2375e+00      1.38e+00       1.36e-03       2.02e+07    
       8             15         5.5534e-02      1.18e+00       5.05e-04       6.02e+06    
       9             17         3.3729e-02      2.18e-02       2.99e-04       5.31e+06    
      10             18         2.7793e-02      5.94e-03       2.83e-04       4.08e+06    
      11             20         2.2068e-02      5.73e-03       9.98e-05       6.46e+05    
      12             22         2.1510e-02      5.58e-04       4.88e-05       2.19e+05    
      13             23         2.0918e-02      5.92e-04       8.55e-05       6.31e+05    
      14             24         2.0250e-02      6.67e-04       1.59e-04       1.43e+06    
      15             25         1.8571e-02      1.68e-03       1.75e-04       9.01e+05    
      16             27         1.7153e-02      1.42e-03       1.09e-04       1.31e+05    
      17             28         1.5923e-02      1.23e-03       1.98e-04       2.86e+05    
      18             30         1.4961e-02      9.63e-04       9.84e-05       1.06e+05    
      19             31         1.4283e-02      6.78e-04       1.70e-04       3.90e+05    
      20             33         1.3766e-02      5.17e-04       8.39e-05       1.62e+05    
      21             34         1.3403e-02      3.63e-04       1.56e-04       5.03e+05    
      22             35         1.2970e-02      4.32e-04       1.49e-04       6.63e+05    
      23             36         1.2546e-02      4.24e-04       1.46e-04       6.20e+05    
      24             38         1.2208e-02      3.38e-04       7.59e-05       9.36e+04    
      25             39         1.1962e-02      2.46e-04       1.51e-04       2.66e+05    
      26             41         1.1666e-02      2.96e-04       7.97e-05       5.73e+04    
      27             42         1.1477e-02      1.89e-04       1.57e-04       2.36e+05    
      28             43         1.1171e-02      3.06e-04       1.57e-04       2.62e+05    
      29             44         1.0892e-02      2.79e-04       1.55e-04       3.24e+05    
      30             45         1.0636e-02      2.56e-04       1.52e-04       3.20e+05    
      31             46         1.0415e-02      2.21e-04       1.50e-04       2.62e+05    
      32             47         1.0225e-02      1.90e-04       1.47e-04       1.82e+05    
      33             48         1.0060e-02      1.65e-04       1.46e-04       1.18e+05    
      34             49         9.9142e-03      1.46e-04       1.45e-04       8.51e+04    
      35             50         9.7841e-03      1.30e-04       1.43e-04       9.61e+04    
      36             51         9.6701e-03      1.14e-04       1.42e-04       1.23e+05    
      37             52         9.5692e-03      1.01e-04       1.41e-04       1.50e+05    
      38             53         9.4783e-03      9.09e-05       1.39e-04       1.71e+05    
Optimization terminated successfully.
`ftol` condition satisfied.
         Current function value: 9.478e-03
         Iterations: 38
         Function evaluations: 53
         Jacobian evaluations: 39
Timer: Solution time = 20.1 min
Timer: Avg time per step = 31.7 sec
Start of solver
Total (sum of squares):  1.390e+09, 
Total force:  5.273e+04 (N)
End of solver
Total (sum of squares):  9.478e-03, 
Total force:  1.377e-01 (N)
Saving latest iteration
Timer: Iteration 1 total = 21.3 min
================
Step 2/3
================
Spectral indexing: fringe
Spectral resolution (L,M,N)=(24,12,3)
Node pattern: quad
Node resolution (L,M,N)=(36,18,6)
Boundary ratio = 0.0
Pressure ratio = 1.0
Perturbation Order = 2
Objective: force
Optimizer: lsq-exact
Function tolerance = 0.01
Gradient tolerance = 1e-06
State vector tolerance = 1e-06
Max function evaluations = 150
================
Perturbing equilibrium
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 673 ms
Timer: Objective build = 857 ms
Perturbing p_l
Factorizing linear constraints
Timer: linear constraint factorize = 781 ms
Computing df
Timer: df computation = 59.3 sec
Factoring df
Timer: df/dx factorization = 11.7 sec
Computing d^2f
Timer: d^2f computation = 44.6 sec
||dx||/||x|| =  1.473e-02
Timer: Total perturbation = 2.15 min
Compiling objective function and derivatives
Timer: Objective compilation time = 10.3 ms
Timer: Jacobian compilation time = 14.1 sec
Timer: Total compilation time = 14.1 sec
Factorizing linear constraints
Timer: linear constraint factorize = 462 ms
Number of parameters: 1590
Number of objectives: 35594
Starting optimization
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         1.3217e+06                                    1.02e+10    
       1              2         1.0262e+05      1.22e+06       6.34e-02       5.06e+09    
       2              3         2.3011e+04      7.96e+04       2.96e-02       2.54e+09    
       3              4         7.1705e+03      1.58e+04       1.63e-02       1.61e+09    
       4              6         7.1678e+02      6.45e+03       1.20e-02       8.18e+07    
       5              8         7.4664e+01      6.42e+02       4.24e-03       1.00e+08    
       6             10         3.4901e+00      7.12e+01       2.76e-03       3.44e+07    
       7             12         3.8200e-01      3.11e+00       1.27e-03       1.07e+07    
       8             14         8.6148e-02      2.96e-01       7.95e-04       1.24e+07    
       9             16         1.3230e-02      7.29e-02       3.58e-04       8.30e+05    
      10             18         9.1300e-03      4.10e-03       2.47e-04       2.83e+05    
      11             20         8.6107e-03      5.19e-04       9.84e-05       1.80e+05    
      12             22         8.5401e-03      7.06e-05       6.36e-05       4.49e+04    
Optimization terminated successfully.
`ftol` condition satisfied.
         Current function value: 8.540e-03
         Iterations: 12
         Function evaluations: 22
         Jacobian evaluations: 13
Timer: Solution time = 6.92 min
Timer: Avg time per step = 34.6 sec
Start of solver
Total (sum of squares):  1.322e+06, 
Total force:  1.626e+03 (N)
End of solver
Total (sum of squares):  8.540e-03, 
Total force:  1.307e-01 (N)
Saving latest iteration
Timer: Iteration 2 total = 10.1 min
================
Step 3/3
================
Spectral indexing: fringe
Spectral resolution (L,M,N)=(24,12,3)
Node pattern: quad
Node resolution (L,M,N)=(36,18,6)
Boundary ratio = 1.0
Pressure ratio = 1.0
Perturbation Order = 2
Objective: force
Optimizer: lsq-exact
Function tolerance = 0.01
Gradient tolerance = 1e-06
State vector tolerance = 1e-06
Max function evaluations = 150
================
Perturbing equilibrium
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 663 ms
Timer: Objective build = 994 ms
Perturbing Rb_lmn, Zb_lmn
Factorizing linear constraints
Timer: linear constraint factorize = 2.00 sec
Computing df
Timer: df computation = 1.04 min
Factoring df
Timer: df/dx factorization = 10.6 sec
Computing d^2f
Timer: d^2f computation = 47.8 sec
||dx||/||x|| =  4.873e-02
Timer: Total perturbation = 2.29 min
Compiling objective function and derivatives
Timer: Objective compilation time = 11.5 ms
Timer: Jacobian compilation time = 17.0 sec
Timer: Total compilation time = 17.1 sec
Factorizing linear constraints
Timer: linear constraint factorize = 887 ms
Number of parameters: 1590
Number of objectives: 35594
Starting optimization
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         1.0535e+13                                    9.10e+16    
