
 ____  ____  _____   ___ 
|  _ \| ___|/  ___|/ ___|
| | \ | |_  | (__ | |
| | | |  _| \___ \| |
| |_/ | |__  ___) | |___ 
|____/|____||____/ \____|
                         

DESC version 0.5.1+123.gd5b23bf.dirty, using JAX backend, jax version=0.2.25, jaxlib version=0.1.76, dtype=float64
Using device: CPU, with 11.93 GB available memory
Reading input from /home/kaya/Documents/edu/pton/plasma/DESC/current/examples/DESC/current/DSHAPE
Outputs will be written to /home/kaya/Documents/edu/pton/plasma/DESC/current/examples/DESC/current/DSHAPE_output.h5
================
Step 1/3
================
Spectral indexing: fringe
Spectral resolution (L,M,N)=(12,6,0)
Node pattern: quad
Node resolution (L,M,N)=(24,12,0)
Boundary ratio = 1.0
Pressure ratio = 0.0
Perturbation Order = 2
Objective: force
Optimizer: lsq-exact
Function tolerance = 0.01
Gradient tolerance = 1e-06
State vector tolerance = 1e-06
Max function evaluations = 100
================
Building objective: force
If this message appears, QuadratureGrid is used to solve eq.
Precomputing transforms
Timer: Precomputing transforms = 589 ms
Timer: Objective build = 591 ms
Compiling objective function and derivatives
Timer: Objective compilation time = 4.31 sec
Timer: Jacobian compilation time = 8.24 sec
Timer: Total compilation time = 12.5 sec
Factorizing linear constraints
Timer: linear constraint factorize = 243 ms
Number of parameters: 57
Number of objectives: 1250
Starting optimization
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         7.7641e+09                                    1.26e+12    
       1              2         2.4433e+09      5.32e+09       7.00e-01       6.40e+11    
       2              4         2.2515e+09      1.92e+08       1.98e-01       3.15e+12    
       3              5         2.3575e+07      2.23e+09       6.29e-02       2.93e+10    
       4              6         7.2022e+06      1.64e+07       9.71e-02       2.12e+10    
       5              7         4.2451e+06      2.96e+06       1.73e-01       1.26e+10    
       6              8         3.8956e+06      3.49e+05       1.69e-01       3.29e+10    
       7              9         4.3819e+04      3.85e+06       4.29e-02       2.53e+09    
       8             11         1.4685e+04      2.91e+04       1.97e-02       7.26e+08    
       9             12         1.0718e+04      3.97e+03       2.50e-02       4.79e+08    
      10             14         4.9027e+03      5.82e+03       6.49e-03       1.88e+07    
      11             15         4.2686e+03      6.34e+02       1.13e-02       2.95e+08    
      12             16         3.6271e+03      6.41e+02       1.09e-02       4.24e+08    
      13             17         3.5227e+03      1.04e+02       1.08e-02       5.43e+08    
      14             18         1.7311e+03      1.79e+03       2.81e-03       2.35e+07    
      15             19         1.6756e+03      5.56e+01       5.64e-03       1.79e+08    
      16             20         1.5159e+03      1.60e+02       5.75e-03       1.93e+08    
      17             21         1.3986e+03      1.17e+02       5.68e-03       1.98e+08    
      18             22         1.3127e+03      8.59e+01       5.55e-03       2.05e+08    
      19             23         1.2597e+03      5.31e+01       5.42e-03       2.22e+08    
      20             24         1.2230e+03      3.66e+01       5.32e-03       2.38e+08    
      21             25         1.0682e+03      1.55e+02       1.30e-03       1.53e+07    
      22             26         1.0614e+03      6.79e+00       2.64e-03       6.34e+07    
Optimization terminated successfully.
`ftol` condition satisfied.
         Current function value: 1.061e+03
         Iterations: 22
         Function evaluations: 26
         Jacobian evaluations: 23
Timer: Solution time = 3.50 sec
Timer: Avg time per step = 159 ms
Start of solver
Total (sum of squares):  7.764e+09, 
Total force:  1.246e+05 (N)
End of solver
Total (sum of squares):  1.061e+03, 
Total force:  4.607e+01 (N)
Saving latest iteration
Timer: Iteration 1 total = 26.6 sec
================
Step 2/3
================
Spectral indexing: fringe
Spectral resolution (L,M,N)=(20,10,0)
Node pattern: quad
Node resolution (L,M,N)=(40,20,0)
Boundary ratio = 1.0
Pressure ratio = 0.0
Perturbation Order = 2
Objective: force
Optimizer: lsq-exact
Function tolerance = 0.01
Gradient tolerance = 1e-06
State vector tolerance = 1e-06
Max function evaluations = 100
================
Building objective: force
If this message appears, QuadratureGrid is used to solve eq.
Precomputing transforms
Timer: Precomputing transforms = 982 ms
Timer: Objective build = 984 ms
Compiling objective function and derivatives
Timer: Objective compilation time = 4.57 sec
Timer: Jacobian compilation time = 8.83 sec
Timer: Total compilation time = 13.4 sec
Factorizing linear constraints
Timer: linear constraint factorize = 241 ms
Number of parameters: 155
Number of objectives: 3362
Starting optimization
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         3.3921e+13                                    6.45e+15    
       1              9         2.8660e+13      5.26e+12       2.74e-01       2.28e+15    
       2             10         2.6048e+13      2.61e+12       3.68e-01       1.75e+15    
       3             11         2.4075e+13      1.97e+12       4.13e-01       1.68e+15    
       4             12         2.2541e+13      1.53e+12       3.57e-01       1.99e+15    
       5             13         2.1021e+13      1.52e+12       2.90e-01       1.32e+15    
       6             14         2.0126e+13      8.95e+11       2.91e-01       1.62e+15    
       7             15         1.8742e+13      1.38e+12       2.38e-01       7.64e+14    
       8             16         1.7926e+13      8.15e+11       2.31e-01       9.36e+14    
       9             17         1.6898e+13      1.03e+12       2.05e-01       3.95e+14    
      10             18         1.6162e+13      7.36e+11       2.01e-01       5.40e+14    
      11             19         1.5364e+13      7.98e+11       1.73e-01       2.23e+14    
      12             20         1.4718e+13      6.46e+11       1.68e-01       2.71e+14    
      13             21         1.4121e+13      5.97e+11       1.43e-01       1.51e+14    
      14             22         1.3339e+13      7.82e+11       2.88e-01       2.77e+14    
      15             23         1.2753e+13      5.86e+11       3.09e-01       2.62e+14    
      16             24         1.2445e+13      3.09e+11       3.43e-01       6.11e+14    
      17             25         1.1994e+13      4.51e+11       8.31e-02       1.83e+14    
      18             26         1.1613e+13      3.81e+11       1.47e-01       4.94e+13    
      19             27         1.1275e+13      3.38e+11       1.25e-01       5.19e+13    
      20             28         1.0706e+13      5.69e+11       2.48e-01       8.12e+13    
      21             30         1.0470e+13      2.35e+11       1.47e-01       7.74e+13    
      22             31         1.0237e+13      2.34e+11       1.37e-01       6.49e+13    
      23             32         9.9195e+12      3.17e+11       2.81e-01       9.90e+13    
      24             33         9.7931e+12      1.26e+11       2.98e-01       1.97e+14    
      25             34         9.5721e+12      2.21e+11       8.20e-02       1.03e+14    
      26             35         9.4225e+12      1.50e+11       1.54e-01       1.08e+14    
      27             36         9.2719e+12      1.51e+11       1.49e-01       3.47e+13    
      28             37         9.1497e+12      1.22e+11       1.55e-01       8.74e+13    
      29             38         9.0186e+12      1.31e+11       1.49e-01       3.26e+13    
      30             39         8.9166e+12      1.02e+11       1.55e-01       9.19e+13    
      31             40         8.8022e+12      1.14e+11       1.50e-01       3.48e+13    
      32             41         8.7204e+12      8.19e+10       1.56e-01       9.99e+13    
Optimization terminated successfully.
`ftol` condition satisfied.
         Current function value: 8.720e+12
         Iterations: 32
         Function evaluations: 41
         Jacobian evaluations: 33
Timer: Solution time = 13.3 sec
Timer: Avg time per step = 418 ms
Start of solver
Total (sum of squares):  3.392e+13, 
Total force:  8.237e+06 (N)
End of solver
Total (sum of squares):  8.720e+12, 
Total force:  4.176e+06 (N)
Saving latest iteration
Timer: Iteration 2 total = 39.2 sec
================
Step 3/3
================
Spectral indexing: fringe
Spectral resolution (L,M,N)=(26,13,0)
Node pattern: quad
Node resolution (L,M,N)=(52,26,0)
Boundary ratio = 1.0
Pressure ratio = 1.0
Perturbation Order = 2
Objective: force
Optimizer: lsq-exact
Function tolerance = 0.01
Gradient tolerance = 1e-06
State vector tolerance = 1e-06
Max function evaluations = 100
================
Perturbing equilibrium
Building objective: force
If this message appears, QuadratureGrid is used to solve eq.
Precomputing transforms
Timer: Precomputing transforms = 2.31 sec
Timer: Objective build = 2.31 sec
Perturbing p_l, c_l
Factorizing linear constraints
Timer: linear constraint factorize = 346 ms
Computing df
Timer: df computation = 18.8 sec
Factoring df
Timer: df/dx factorization = 125 ms
Computing d^2f
Timer: d^2f computation = 23.9 sec
||dx||/||x|| =  1.065e-01
Timer: Total perturbation = 48.9 sec
Compiling objective function and derivatives
Timer: Objective compilation time = 2.43 ms
Timer: Jacobian compilation time = 376 ms
Timer: Total compilation time = 379 ms
Factorizing linear constraints
Timer: linear constraint factorize = 14.8 ms
Number of parameters: 260
Number of objectives: 5618
Starting optimization
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1         6.0603e+30                                    1.94e+36    
       1              3         2.9778e+29      5.76e+30       7.31e+00       1.01e+35    
       2              4         4.7925e+27      2.93e+29       3.76e+00       1.99e+33    
       3              8         1.7625e+27      3.03e+27       3.60e+00       1.48e+33    
       4              9         7.3241e+22      1.76e+27       1.67e+00       8.26e+28    
       5             10         1.8322e+22      5.49e+22       2.08e+00       1.16e+28    
       6             11         3.5756e+21      1.47e+22       5.49e+00       1.42e+27    
       7             12         6.7452e+20      2.90e+21       4.34e+00       2.09e+26    
       8             13         8.1522e+18      6.66e+20       2.53e+00       1.26e+25    
       9             17         2.4772e+17      7.90e+18       7.62e-01       6.62e+23    
      10             22         1.9737e+17      5.03e+16       6.79e-02       1.64e+22    
      11             23         1.3996e+17      5.74e+16       8.80e-03       2.48e+22    
      12             24         1.3102e+17      8.94e+15       7.91e-03       2.00e+22    
      13             25         1.2238e+17      8.65e+15       2.56e-03       1.97e+22    
      14             26         1.2087e+17      1.51e+15       2.08e-03       2.06e+22    
      15             28         1.2053e+17      3.41e+14       7.34e-04       2.05e+22    
Optimization terminated successfully.
`ftol` condition satisfied.
         Current function value: 1.205e+17
         Iterations: 15
         Function evaluations: 28
         Jacobian evaluations: 16
Timer: Solution time = 14.4 sec
Timer: Avg time per step = 961 ms
Start of solver
Total (sum of squares):  6.060e+30, 
Total force:  3.481e+15 (N)
End of solver
Total (sum of squares):  1.205e+17, 
Total force:  4.910e+08 (N)
Saving latest iteration
Timer: Iteration 3 total = 1.37 min
====================
Done
Timer: Total time = 2.47 min
Output written to /home/kaya/Documents/edu/pton/plasma/DESC/current/examples/DESC/current/DSHAPE_output.h5
====================
